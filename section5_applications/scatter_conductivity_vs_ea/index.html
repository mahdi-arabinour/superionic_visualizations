<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Activation Energy vs Conductivity</title>
<script src="https://d3js.org/d3.v7.min.js"></script>
<style>
  body { font-family: sans-serif; background: #fafafa; margin: 30px; }
  svg { width: 900px; height: 600px; }
  .axis-label { font-size: 14px; font-weight: 600; }
  .point { fill: steelblue; opacity: 0.8; }
  .tooltip {
    position: absolute; background: white; border: 1px solid #ccc;
    padding: 6px 10px; border-radius: 4px; font-size: 13px;
    pointer-events: none; box-shadow: 0 1px 3px rgba(0,0,0,0.2);
  }
</style>
</head>
<body>
<h2>Activation Energy (eV) vs Conductivity (S/cm)</h2>
<svg></svg>
<div class="tooltip" style="opacity:0"></div>

<script>
const svg = d3.select("svg");
const width = svg.attr("width") || 900;
const height = svg.attr("height") || 600;
const margin = {top:40, right:40, bottom:60, left:80};
const innerW = width - margin.left - margin.right;
const innerH = height - margin.top - margin.bottom;

const g = svg.append("g").attr("transform",`translate(${margin.left},${margin.top})`);
const tooltip = d3.select(".tooltip");

d3.csv("data.csv").then(data => {
  // Parse numeric columns safely
  const points = data.map(d => ({
    Ea: +d["Activation Energy Ea (eV)"],
    cond: +d["Conductivity σ (S·cm⁻¹) / Temp (°C) normalized"]
  })).filter(d => isFinite(d.Ea) && isFinite(d.cond) && d.cond > 0);

  const x = d3.scaleLinear()
    .domain(d3.extent(points, d => d.Ea)).nice()
    .range([0, innerW]);
  const y = d3.scaleLog()
    .domain(d3.extent(points, d => d.cond)).nice()
    .range([innerH, 0]);

  g.append("g").attr("transform",`translate(0,${innerH})`).call(d3.axisBottom(x));
  g.append("g").call(d3.axisLeft(y).ticks(6, "~g"));

  g.append("text").attr("class","axis-label")
    .attr("x", innerW/2).attr("y", innerH+45)
    .attr("text-anchor","middle").text("Activation Energy (eV)");
  g.append("text").attr("class","axis-label")
    .attr("x",-innerH/2).attr("y",-55).attr("transform","rotate(-90)")
    .attr("text-anchor","middle").text("Conductivity (S/cm)");

  g.selectAll(".point").data(points).enter().append("circle")
    .attr("class","point")
    .attr("cx", d => x(d.Ea))
    .attr("cy", d => y(d.cond))
    .attr("r", 5)
    .on("mouseover", (e,d) => {
      tooltip.style("opacity",1)
        .html(`Ea: ${d.Ea}<br>σ: ${d.cond}`)
        .style("left", (e.pageX+10)+"px")
        .style("top", (e.pageY-20)+"px");
    })
    .on("mouseout", () => tooltip.style("opacity",0));
});
</script>
</body>
</html>
